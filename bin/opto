#!/usr/bin/env ruby
require 'slop'
require 'byebug'

$:.unshift File.join( File.dirname(__FILE__), "/../lib")

require 'opto'

opts = Slop.parse do |o|
  o.string '-d', '--database', 'Database'
  o.on '-h', '--help' do
    puts o
    exit
  end
end

server = Opto::Server.new( ARGV[0] )


Opto.registered.each do |op|

  if op.supports?( server )
    puts op.description
    suite = op.new(server)
    suite.check
  end

end

server.result.report
